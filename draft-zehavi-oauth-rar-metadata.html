<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OAuth 2.0 RAR Metadata and Error Signaling</title>
<meta content="Yaron Zehavi" name="author">
<meta content="
       OAuth 2.0 Rich Authorization Requests (RAR), as defined in  , enables fine-grained authorization requests, using structured JSON objects. 
       While RAR   standardizes the exchange and handling of authorization details, it does not define a mechanism for clients to discover how to construct valid authorization details types. 
       This document defines a machine-readable metadata format for authorization servers to provide authorization details type documentation and JSON Schema   definitions, as well as interoperable discovery via OAuth Resource Server Metadata  . 
       This document also defines a new WWW-Authenticate normative OAuth error code,  insufficient_authorization_details , enabling resource servers to indicate inadequate authorization details as the cause of failure. 
       It also defines an  OPTIONAL  response body which  MAY  be returned alongside the  insufficient_authorization_details  error, providing an informative yet actionable authorization details object, which can be used directly in a subsequent OAuth request. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="RAR" name="keyword">
<meta content="Step-up" name="keyword">
<meta content="oauth" name="keyword">
<meta content="draft-zehavi-oauth-rar-metadata-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.2.1
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.3.0
-->
<link href="draft-zehavi-oauth-rar-metadata.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
  border-left: 2px var(--pilcrow-strong) solid;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow, a.pilcrow:focus {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">OAuth 2.0 RAR Metadata and Error Signali</td>
<td class="right">February 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">Zehavi</td>
<td class="center">Expires 15 August 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Web Authorization Protocol</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-zehavi-oauth-rar-metadata-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-02-11" class="published">11 February 2026</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-08-15">15 August 2026</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">Y. Zehavi</div>
<div class="org">Raiffeisen Bank International</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OAuth 2.0 RAR Metadata and Error Signaling</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">OAuth 2.0 Rich Authorization Requests (RAR), as defined in <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span>, enables fine-grained authorization requests, using structured JSON objects.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">While RAR <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span> standardizes the exchange and handling of authorization details, it does not define a mechanism for clients to discover how to construct valid authorization details types.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This document defines a machine-readable metadata format for authorization servers to provide authorization details type documentation and JSON Schema <span>[<a href="#JSON.Schema" class="cite xref">JSON.Schema</a>]</span> definitions, as well as interoperable discovery via OAuth Resource Server Metadata <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
<p id="section-abstract-4">This document also defines a new WWW-Authenticate normative OAuth error code, <code>insufficient_authorization_details</code>, enabling resource servers to indicate inadequate authorization details as the cause of failure.<a href="#section-abstract-4" class="pilcrow">¶</a></p>
<p id="section-abstract-5">It also defines an <span class="bcp14">OPTIONAL</span> response body which <span class="bcp14">MAY</span> be returned alongside the <code>insufficient_authorization_details</code> error, providing an informative yet actionable authorization details object, which can be used directly in a subsequent OAuth request.<a href="#section-abstract-5" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://yaron-zehavi.github.io/oauth-rich-authorization-requests-metadata/draft-zehavi-oauth-rar-metadata.html">https://yaron-zehavi.github.io/oauth-rich-authorization-requests-metadata/draft-zehavi-oauth-rar-metadata.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-zehavi-oauth-rar-metadata/">https://datatracker.ietf.org/doc/draft-zehavi-oauth-rar-metadata/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Web Authorization Protocol Working Group mailing list (<span><a href="mailto:oauth@ietf.org">mailto:oauth@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/oauth/">https://mailarchive.ietf.org/arch/browse/oauth/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/oauth/">https://www.ietf.org/mailman/listinfo/oauth/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/yaron-zehavi/oauth-rich-authorization-requests-metadata">https://github.com/yaron-zehavi/oauth-rich-authorization-requests-metadata</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 15 August 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2026 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-client-obtains-metadata-of-" class="internal xref">Client obtains metadata of required authorization details types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-client-obtains-authorizatio" class="internal xref">Client obtains authorization details object from resource server's error response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-oauth-20-protected-resource" class="internal xref">OAuth 2.0 Protected Resource Metadata RFC9728</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-required-types-expression-s" class="internal xref">Required types expression syntax</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-required-types-expression-e" class="internal xref">Required types expression examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-example-expression-using-an" class="internal xref">Example expression using "and" operator</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-example-expression-using-or" class="internal xref">Example expression using "or" operator</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="auto internal xref">4.2.3</a>.  <a href="#name-example-expression-using-co" class="internal xref">Example expression using "constraints" operator</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-authorization-details-types" class="internal xref">Authorization Details Types Metadata Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-authorization-details-types-" class="internal xref">Authorization Details Types Metadata Endpoint Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-resource-server-error-signa" class="internal xref">Resource Server Error Signaling of Inadequate authorization_details</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-optional-authorization_deta" class="internal xref">OPTIONAL authorization_details in response body</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-processing-rules" class="internal xref">Processing Rules</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-client-processing-rules" class="internal xref">Client Processing Rules</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-resource-server-processing-" class="internal xref">Resource Server Processing Rules</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-cacheability-and-intermedia" class="internal xref">Cacheability and Intermediaries</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-oauth-20-bearer-token-error" class="internal xref">OAuth 2.0 Bearer Token Error Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-oauth-metadata-attribute-re" class="internal xref">OAuth Metadata Attribute Registration</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-metadata-examples" class="internal xref">Metadata Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.1">
                    <p id="section-toc.1-1.11.2.1.2.1.1"><a href="#appendix-A.1.1" class="auto internal xref">A.1.1</a>.  <a href="#name-example-authorization_detai" class="internal xref">Example authorization_details_types_metadata_endpoint response with Payment Initiation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-payment-initiation-with-rar" class="internal xref">Payment initiation with RAR error signaling</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.1">
                    <p id="section-toc.1-1.11.2.2.2.1.1"><a href="#appendix-A.2.1" class="auto internal xref">A.2.1</a>.  <a href="#name-client-initiates-api-reques" class="internal xref">Client initiates API request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.2">
                    <p id="section-toc.1-1.11.2.2.2.2.1"><a href="#appendix-A.2.2" class="auto internal xref">A.2.2</a>.  <a href="#name-resource-server-signals-ins" class="internal xref">Resource server signals insufficient_authorization_details with actionable RAR object</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.3">
                    <p id="section-toc.1-1.11.2.2.2.3.1"><a href="#appendix-A.2.3" class="auto internal xref">A.2.3</a>.  <a href="#name-client-initiates-oauth-flow" class="internal xref">Client initiates OAuth flow using the provided authorization_details object</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.4">
                    <p id="section-toc.1-1.11.2.2.2.4.1"><a href="#appendix-A.2.4" class="auto internal xref">A.2.4</a>.  <a href="#name-client-re-attempts-api-requ" class="internal xref">Client re-attempts API request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.5">
                    <p id="section-toc.1-1.11.2.2.2.5.1"><a href="#appendix-A.2.5" class="auto internal xref">A.2.5</a>.  <a href="#name-resource-server-authorizes-" class="internal xref">Resource server authorizes the request</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">OAuth 2.0 Rich Authorization Requests (RAR) <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span> allows OAuth clients to request structured, fine-grained authorization, beyond the coarse-grained access offered by simple scopes, which has enabled advanced authorization models across many domains, such as open banking &amp; API marketplaces.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">However, RAR <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span> does not specify how a client learns how to construct syntactically valid authorization details objects. As a result, clients must rely on out-of-band documentation or static ecosystem profiles, limiting interoperability and preventing dynamic client behavior.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document addresses this gap by:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.1">
          <p id="section-1-4.1.1">Defining a new authorization server endpoint: <code>authorization_details_types_metadata_endpoint</code>, providing metadata for authorization details types, including human-readable documentation as well as embedded JSON Schema definitions <span>[<a href="#JSON.Schema" class="cite xref">JSON.Schema</a>]</span>.<a href="#section-1-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.2">
          <p id="section-1-4.2.1">Adding accepted authorization details types to OAuth 2.0 Protected Resource Metadata <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span> response, facilitating RAR metadata discovery.<a href="#section-1-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.3">
          <p id="section-1-4.3.1">Defining a standardized error signaling mechanism using the WWW-Authenticate response header, allowing resource servers to specify <code>insufficient_authorization_details</code> as the cause of error.<a href="#section-1-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.4">
          <p id="section-1-4.4.1">Defining an <span class="bcp14">OPTIONAL</span> response body, included with an <code>insufficient_authorization_details</code> error, providing an informative authorization details object, whose inclusion in a new OAuth request shall result, if approved, in an access token satisfying the endpoint's requirements.<a href="#section-1-4.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-5">The <span class="bcp14">OPTIONAL</span> providing of actionable authorization details objects by resource servers enables:<a href="#section-1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-6.1">
          <p id="section-1-6.1.1">High interoperability and simplification by relieving clients from having to figure out how to construct valid authorization details objects, instead providing them with required authorization_details object, to be included in a subsequent OAuth request.<a href="#section-1-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-6.2">
          <p id="section-1-6.2.1">Support for including ephemeral, interaction-specific details originating from the resource domain, in the authorization details object, such as for example a risk score, a risk profile or an internal interaction identifier. Resource servers <span class="bcp14">MAY</span> use this to guide authorization servers as to the required authentication strength and consent flow.<a href="#section-1-6.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol-overview">
<section id="section-3">
      <h2 id="name-protocol-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-3-1">There are two main proposed flows:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">
          <p id="section-3-2.1.1">Client obtains <strong>metadata</strong> of required authorization details types.<a href="#section-3-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.2">
          <p id="section-3-2.2.1">Client obtains an <strong>actionable authorization details object</strong> from resource server's error response.<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="client-obtains-metadata-of-required-authorization-details-types">
<section id="section-3.1">
        <h3 id="name-client-obtains-metadata-of-">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-client-obtains-metadata-of-" class="section-name selfRef">Client obtains metadata of required authorization details types</a>
        </h3>
<div class="alignLeft art-ascii-art art-text artwork" id="section-3.1-1">
<pre>
                                                +---------------------+
             +----------+ (B) API Request       |                     |
             |          |----------------------&gt;|      Resource       |
(A) User +---|          |                       |       Server        |
   Starts|   |          |&lt;----------------------|                     |
   Flow  +--&gt;|          | (C) 403 Forbidden     +---------------------+
             |          |     WWW-Authenticate: Bearer
             |          |     error="insufficient_authorization_details",
             |          |     resource_metadata="[resource metadata url]"
             |          |           :
             |          |        Resource       +---------------------+
             |          | (D) Metadata Request  |   Resource Server   |
             |          |----------------------&gt;|+-------------------+|
             |          |                       || Resource Metadata ||
             |  Client  |&lt;----------------------||    Endpoint       ||
             |          | (E) Metadata Response |+-------------------+|
             |          |    (Discover also     +---------------------+
             |          |     expected RAR types)
             |          |           :           +---------------------+
             |          |        RAR Types      |    Authorization    |
             |          | (F) Metadata Request  |       Server        |
             |          |----------------------&gt;|+-------------------+|
             |          |                       ||     RAR Types     ||
             |          |&lt;----------------------|| Metadata Endpoint ||
             |          | (G) Metadata Response |+-------------------+|
             |          |           :           |                     |
             |          | (H) Construct RAR     |                     |
             |          |     Using Metadata    |                     |
             |          |        :              |                     |
             |          | (I) Authorization     |                     |
             |          |     Request + RAR     |                     |
             |          |----------------------&gt;|+-------------------+|
             |          |                       ||   Authorization   ||
             |          |&lt;----------------------||     Endpoint      ||
             |          | (J) Authorization Code||                   ||
             |          |        :              |+-------------------+|
             |          |        :              |                     |
             |          | (K) Token Request     |+-------------------+|
             |          |----------------------&gt;||                   ||
             |          |                       ||   Token Endpoint  ||
             |          |&lt;----------------------||                   ||
             |          | (L) Access Token      |+-------------------+|
             |          |        :              +---------------------+
             |          |        :
             |          | (M) API Call with
             |          |     Access Token      +---------------------+
             |          |----------------------&gt;|                     |
             |          |                       |   Resource Server   |
             |          |&lt;----------------------|                     |
             |          | (N) 200 OK + Resource +---------------------+
             |          |
             +----------+
</pre><a href="#section-3.1-1" class="pilcrow">¶</a>
</div>
<p id="section-3.1-2">Figure: Client learns to construct valid authorization details objects from metadata<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-3.1">
            <p id="section-3.1-3.1.1">(A) The user starts the flow.<a href="#section-3.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.2">
            <p id="section-3.1-3.2.1">(B) The client calls an API with an access token.<a href="#section-3.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.3">
            <p id="section-3.1-3.3.1">(C) Resource server returns HTTP 403 forbidden including a WWW-Authenticate header with error code <code>insufficient_authorization_details</code> and the resource metadata url (OAuth 2.0 Protected Resource Metadata <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>).<a href="#section-3.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.4">
            <p id="section-3.1-3.4.1">(D-E) The client discovers expected authorization details types from resource metadata endpoint's response.<a href="#section-3.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.5">
            <p id="section-3.1-3.5.1">(F-G) The client consumes authorization details type metadata from authorization server's <code>authorization_details_types_metadata_endpoint</code>.<a href="#section-3.1-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.6">
            <p id="section-3.1-3.6.1">(H-I) The client constructs a valid authorization details object and makes an OAuth + RAR <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span> request.<a href="#section-3.1-3.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.7">
            <p id="section-3.1-3.7.1">(J) Authorization server returns authorization code.<a href="#section-3.1-3.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.8">
            <p id="section-3.1-3.8.1">(K-L) The client exchanges authorization code for access token.<a href="#section-3.1-3.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.9">
            <p id="section-3.1-3.9.1">(M) The client makes an API request with the (RAR) access token.<a href="#section-3.1-3.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.10">
            <p id="section-3.1-3.10.1">(N) Resource server validates access token and returns successful response.<a href="#section-3.1-3.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="client-obtains-authorization-details-object-from-resource-servers-error-response">
<section id="section-3.2">
        <h3 id="name-client-obtains-authorizatio">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-client-obtains-authorizatio" class="section-name selfRef">Client obtains authorization details object from resource server's error response</a>
        </h3>
<div class="alignLeft art-ascii-art art-text artwork" id="section-3.2-1">
<pre>
                                                +--------------------+
             +----------+ (B) API Request       |                    |
             |          |----------------------&gt;|      Resource      |
(A) User +---|          |                       |       Server       |
   Starts|   |          |&lt;----------------------|                    |
   Flow  +--&gt;|  Client  | (C) 403 Forbidden     +--------------------+
             |          |     WWW-Authenticate: Bearer
             |          |     error="insufficient_authorization_details",
             |          |     resource_metadata="[resource metadata url]"
             |          |        +
             |          |     HTTP body provides authorization_details
             |          |        :
             |          |        :              +--------------------+
             |          |        :              |   Authorization    |
             |          | (D) Authorization     |      Server        |
             |          |     Request + RAR     |+------------------+|
             |          |----------------------&gt;||                  ||
             |          |                       ||  Authorization   ||
             |          |&lt;----------------------||    Endpoint      ||
             |          | (E) Authorization Code||                  ||
             |          |        :              |+------------------+|
             |          |        :              |                    |
             |          | (G) Token Request     |+------------------+|
             |          |----------------------&gt;||                  ||
             |          |                       || Token Endpoint   ||
             |          |&lt;----------------------||                  ||
             |          | (H) Access Token      |+------------------+|
             |          |        :              +--------------------+
             |          |        :
             |          |        :
             |          | (I) Retry API Call    +--------------------+
             |          |     with Token        |                    |
             |          |----------------------&gt;|      Resource      |
             |          |                       |       Server       |
             |          |&lt;----------------------|                    |
             |          | (J) 200 OK + Resource +--------------------+
             |          |
             +----------+
</pre><a href="#section-3.2-1" class="pilcrow">¶</a>
</div>
<p id="section-3.2-2">Figure: Client obtains authorization details object from resource server's error response<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-3.1">
            <p id="section-3.2-3.1.1">(A) The user starts the flow.<a href="#section-3.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.2">
            <p id="section-3.2-3.2.1">(B) The client calls an API with an access token.<a href="#section-3.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.3">
            <p id="section-3.2-3.3.1">(C) Resource server returns HTTP 403 forbidden including a WWW-Authenticate header with error code <code>insufficient_authorization_details</code> and in the response body <strong>includes the authorization details object requiring approval</strong>.<a href="#section-3.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.4">
            <p id="section-3.2-3.4.1">(D) The client uses the obtained authorization details object in a new OAuth + RAR <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span> request.<a href="#section-3.2-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.5">
            <p id="section-3.2-3.5.1">(E) Authorization server returns authorization code.<a href="#section-3.2-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.6">
            <p id="section-3.2-3.6.1">(G-H) The client exchanges authorization code for access token.<a href="#section-3.2-3.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.7">
            <p id="section-3.2-3.7.1">(I) The client makes an API request with the (RAR) access token.<a href="#section-3.2-3.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.8">
            <p id="section-3.2-3.8.1">(J) Resource server validates access token and returns successful response.<a href="#section-3.2-3.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="oauth-20-protected-resource-metadata-rfc9728">
<section id="section-4">
      <h2 id="name-oauth-20-protected-resource">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-oauth-20-protected-resource" class="section-name selfRef">OAuth 2.0 Protected Resource Metadata <span class="cite xref">[RFC9728]</span></a>
      </h2>
<p id="section-4-1">This document specifies a new <span class="bcp14">OPTIONAL</span> metadata attribute: <code>authorization_details_types_supported</code>, to be included in the response of OAuth Protected Resource Metadata <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4-2">
        <dt id="section-4-2.1">"authorization_details_types_supported":</dt>
        <dd style="margin-left: 1.5em" id="section-4-2.2">
          <p id="section-4-2.2.1"><span class="bcp14">OPTIONAL</span>.  a JSON object that conforms to the syntax described in <a href="#syntax" class="auto internal xref">Section 4.1</a> for a <em>required types expression</em>.<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-4-3">The following is a non-normative example response with the added <code>authorization_details_types_supported</code> attribute:<a href="#section-4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-4">
<pre>
GET /.well-known/oauth-protected-resource/payments HTTP/1.1
Host: resource.example.com

..
..

HTTP/1.1 200 OK
Content-Type: application/json

{
  "resource":
  "https://resource.example.com/payments",
  "authorization_servers":
    ["https://as1.example.com",
     "https://as2.example.net"],
  "bearer_methods_supported":
    ["header", "body"],
  "scopes_supported": ["payment"],
  "resource_documentation":
    "https://resource.example.com/docs/payments.html",
  "authorization_details_types_supported":
    "oneOf": ["payment_initiation", "payment_approval",
              "beneficiary_designation"]
}
</pre><a href="#section-4-4" class="pilcrow">¶</a>
</div>
<p id="section-4-5">Note: When resource servers accept access tokens <em>from several authorization servers</em>, interoperability is maintained and confusion is prevented, because clients can discover which authorization details types each authorization server supports.<a href="#section-4-5" class="pilcrow">¶</a></p>
<div id="syntax">
<section id="section-4.1">
        <h3 id="name-required-types-expression-s">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-required-types-expression-s" class="section-name selfRef">Required types expression syntax</a>
        </h3>
<p id="section-4.1-1">The following JSON syntax defines a <strong>required types expression</strong> to declaratively describe permitted combinations of required <em>authorization_details</em> types. This expression allows selection operators (oneOf, allOf, constraints) and boolean composition (and, or) to be combined in a predictable manner.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">A <strong>required types expression</strong> is a JSON object that <span class="bcp14">MUST</span> contain <strong>exactly</strong> one of the following attributes:<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-3.1">
            <p id="section-4.1-3.1.1">and<a href="#section-4.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.2">
            <p id="section-4.1-3.2.1">or<a href="#section-4.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.3">
            <p id="section-4.1-3.3.1">oneOf<a href="#section-4.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.4">
            <p id="section-4.1-3.4.1">allOf<a href="#section-4.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.5">
            <p id="section-4.1-3.5.1">constraints<a href="#section-4.1-3.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-4">Attributes definition:<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-5">
          <dt id="section-4.1-5.1">"and":</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.2">
            <p id="section-4.1-5.2.1"><span class="bcp14">OPTIONAL</span>.  a non-empty JSON array of <em>required types expressions</em>. When <strong>and</strong> is specified, the expression is satisfied if <strong>all</strong> contained expressions are satisfied.<a href="#section-4.1-5.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.3">"or":</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.4">
            <p id="section-4.1-5.4.1"><span class="bcp14">OPTIONAL</span>.  a non-empty JSON array of <em>required types expressions</em>. When <strong>or</strong> is specified, the expression is satisfied if <strong>at least one</strong> contained expression is satisfied.<a href="#section-4.1-5.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.5">"oneOf":</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.6">
            <p id="section-4.1-5.6.1"><span class="bcp14">OPTIONAL</span>.  a non-empty JSON array of strings identifying authorization_details types. When <strong>oneOf</strong> is specified, the expression is satisfied if <strong>exactly one</strong> of the listed types is present.<a href="#section-4.1-5.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.7">"allOf":</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.8">
            <p id="section-4.1-5.8.1"><span class="bcp14">OPTIONAL</span>.  a non-empty JSON array of strings identifying authorization_details types. When <strong>allOf</strong> is specified, the expression is satisfied if <strong>all</strong> of the listed types are present.<a href="#section-4.1-5.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.9">"constraints":</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.10">
            <p id="section-4.1-5.10.1"><span class="bcp14">OPTIONAL</span>.  a JSON object defining cardinality and exclusion constraints over a set of authorization_details types. The object <span class="bcp14">MUST</span> contain the <strong>types</strong> attribute and <span class="bcp14">MAY</span> contain the attributes <strong>min</strong>, <strong>max</strong>, <strong>exact</strong>, and <strong>forbidden</strong>.<a href="#section-4.1-5.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.11">"types":</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.12">
            <p id="section-4.1-5.12.1"><span class="bcp14">REQUIRED</span>.  a non-empty JSON array of strings identifying the authorization_details types to which the constraints apply.<a href="#section-4.1-5.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.13">"min":</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.14">
            <p id="section-4.1-5.14.1"><span class="bcp14">OPTIONAL</span>.  a non-negative integer indicating the minimum number of authorization_details types from <code>types</code> that <span class="bcp14">MUST</span> be present. This attribute <span class="bcp14">MUST NOT</span> be used together with the <strong>exact</strong> attribute.<a href="#section-4.1-5.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.15">"max":</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.16">
            <p id="section-4.1-5.16.1"><span class="bcp14">OPTIONAL</span>.  a non-negative integer indicating the maximum number of authorization_details types from <code>types</code> that <span class="bcp14">MAY</span> be present. This attribute <span class="bcp14">MUST NOT</span> be used together with the <strong>exact</strong> attribute.<a href="#section-4.1-5.16.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.17">"exact":</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.18">
            <p id="section-4.1-5.18.1"><span class="bcp14">OPTIONAL</span>.  a non-negative integer indicating the exact number of authorization_details types from <code>types</code> that <span class="bcp14">MUST</span> be present. This attribute <span class="bcp14">MUST NOT</span> be used together with the <strong>min</strong> or <strong>max</strong> attributes.<a href="#section-4.1-5.18.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.19">"forbidden":</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-5.20">
            <p id="section-4.1-5.20.1"><span class="bcp14">OPTIONAL</span>.  a non-empty JSON array, each element of which is an array of authorization_details types identifiers, representing a combination that <span class="bcp14">MUST NOT</span> be present together.<a href="#section-4.1-5.20.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="required-types-expression-examples">
<section id="section-4.2">
        <h3 id="name-required-types-expression-e">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-required-types-expression-e" class="section-name selfRef">Required types expression examples</a>
        </h3>
<div id="example-expression-using-and-operator">
<section id="section-4.2.1">
          <h4 id="name-example-expression-using-an">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-example-expression-using-an" class="section-name selfRef">Example expression using "and" operator</a>
          </h4>
<p id="section-4.2.1-1">Specifies that the selection <span class="bcp14">MUST</span> include a and b, <strong>and</strong> one of c <strong>or</strong> d.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-2">
<pre>
{
  "required_types": {
    "and": [
      { "allOf": ["a", "b"] },
      { "oneOf": ["c", "d"] }
    ]
  }
}
</pre><a href="#section-4.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-3">Specifies that the selection <span class="bcp14">MUST</span> include one of a or b, <strong>and</strong> exactly two of [c,d,e], but the combination of d and e together is forbidden.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-4">
<pre>
{
  "required_types": {
    "and": [
      { "oneOf": ["a", "b"] },
      {
        "constraints": {
          "types": ["c", "d", "e"],
          "exact": 2,
          "forbidden": [["d", "e"]]
        }
      }
    ]
  }
}
</pre><a href="#section-4.2.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-expression-using-or-operator">
<section id="section-4.2.2">
          <h4 id="name-example-expression-using-or">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-example-expression-using-or" class="section-name selfRef">Example expression using "or" operator</a>
          </h4>
<p id="section-4.2.2-1">Specifies that the selection <span class="bcp14">MUST</span> include <strong>either</strong> c <strong>and</strong> d, <strong>or</strong> one of a or b.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.2-2">
<pre>
{
  "required_types": {
    "or": [
      { "allOf": ["c", "d"] },
      { "oneOf": ["a", "b"] }
    ]
  }
}
</pre><a href="#section-4.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-expression-using-constraints-operator">
<section id="section-4.2.3">
          <h4 id="name-example-expression-using-co">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-example-expression-using-co" class="section-name selfRef">Example expression using "constraints" operator</a>
          </h4>
<p id="section-4.2.3-1">Specifies that at least two of {a,b,c} <span class="bcp14">MUST</span> be present, but the combination of a and c together is forbidden.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.3-2">
<pre>
{
  "required_types": {
    "constraints": {
      "types": ["a","b","c"],
      "min": 2,
      "forbidden": [ ["a","c"] ]
    }
  }
}
</pre><a href="#section-4.2.3-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.3-3">Specifies that exactly two of {a,b,c} <span class="bcp14">MUST</span> be present.<a href="#section-4.2.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.3-4">
<pre>
{
  "required_types": {
    "constraints": {
      "types": ["a","b","c"],
      "exact": 2
    }
  }
}
</pre><a href="#section-4.2.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="authorization-details-types-metadata-endpoint">
<section id="section-5">
      <h2 id="name-authorization-details-types">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-authorization-details-types" class="section-name selfRef">Authorization Details Types Metadata Endpoint</a>
      </h2>
<p id="section-5-1">The following authorization server metadata <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span> parameter is introduced to signal the server's support for Authorization Details Types Metadata:<a href="#section-5-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5-2">
        <dt id="section-5-2.1">"authorization_details_types_metadata_endpoint":</dt>
        <dd style="margin-left: 1.5em" id="section-5-2.2">
          <p id="section-5-2.2.1"><span class="bcp14">OPTIONAL</span>.  The URL of the Authorization Details Types Metadata endpoint.<a href="#section-5-2.2.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<div id="authorization-details-types-metadata-endpoint-response">
<section id="section-5.1">
        <h3 id="name-authorization-details-types-">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-authorization-details-types-" class="section-name selfRef">Authorization Details Types Metadata Endpoint Response</a>
        </h3>
<p id="section-5.1-1">The Authorization Details Types Metadata endpoint's response is a JSON document with the key <code>authorization_details_types_metadata</code> whose attributes are authorization details type identifiers.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Each identifier is an object describing a single authorization details type.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-3">
<pre>
{
  "authorization_details_types_metadata": {
    "type": {
    "version": "...",
    "description": "...",
    "documentation_uri": "...",
    "schema": { },
    "schema_uri": "...",
    "examples": [ ]
    }
  }
}
</pre><a href="#section-5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1-4">Attributes definition:<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-5">
          <dt id="section-5.1-5.1">"version":</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-5.2">
            <p id="section-5.1-5.2.1"><span class="bcp14">OPTIONAL</span>. String identifying the version of the authorization details type definition. The value is informational and does not imply semantic version negotiation.<a href="#section-5.1-5.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-5.3">"description":</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-5.4">
            <p id="section-5.1-5.4.1"><span class="bcp14">OPTIONAL</span>. String containing a human-readable description of the authorization details type. Clients <span class="bcp14">MUST NOT</span> rely on this value for authorization or validation decisions.<a href="#section-5.1-5.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-5.5">"documentation_uri":</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-5.6">
            <p id="section-5.1-5.6.1"><span class="bcp14">OPTIONAL</span>. URI referencing external human-readable documentation describing the authorization details type.<a href="#section-5.1-5.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-5.7">"schema":</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-5.8">
            <p id="section-5.1-5.8.1">The <code>schema</code> attribute is a JSON Schema document <span>[<a href="#JSON.Schema" class="cite xref">JSON.Schema</a>]</span> describing a single authorization detail object. The schema <span class="bcp14">MUST</span> validate a single authorization detail object and <span class="bcp14">MUST</span> constrain the <code>type</code> attribute to the authorization detail type identifier. This attribute is <span class="bcp14">REQUIRED</span> unless <code>schema_uri</code> is specified. If this attribute is present, <code>schema_uri</code> <span class="bcp14">MUST NOT</span> be present.<a href="#section-5.1-5.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-5.9">"schema_uri":</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-5.10">
            <p id="section-5.1-5.10.1">The <code>schema_uri</code> attribute is an absolute URI, as defined by RFC 3986 <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>, referencing a JSON Schema document describing a single authorization details object. The referenced schema <span class="bcp14">MUST</span> satisfy the same requirements as the <code>schema</code> attribute. This attribute is <span class="bcp14">REQUIRED</span> unless <code>schema</code> is specified. If this attribute is present, <code>schema</code> <span class="bcp14">MUST NOT</span> be present.<a href="#section-5.1-5.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-5.11">"examples":</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-5.12">
            <p id="section-5.1-5.12.1"><span class="bcp14">OPTIONAL</span>. An array of example authorization details objects. Examples are non-normative.<a href="#section-5.1-5.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.1-6">See Examples <a href="#metadata-examples" class="auto internal xref">Appendix A.1</a> for non-normative response example.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="resource-server-error-signaling-of-inadequate-authorizationdetails">
<section id="section-6">
      <h2 id="name-resource-server-error-signa">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-resource-server-error-signa" class="section-name selfRef">Resource Server Error Signaling of Inadequate authorization_details</a>
      </h2>
<p id="section-6-1">This document defines a new normative OAuth error code, <code>insufficient_authorization_details</code>, which resource servers <span class="bcp14">SHALL</span> return using the <code>WWW-Authenticate</code> header, to signal access is denied due to missing or insufficient authorization details.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Example HTTP response:<a href="#section-6-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6-3">
<pre>
HTTP/1.1 403 Forbidden
WWW-Authenticate: Bearer error="insufficient_authorization_details",
    resource_metadata="https://resource.example.com/
    .well-known/oauth-protected-resource/payments"
</pre><a href="#section-6-3" class="pilcrow">¶</a>
</div>
<div id="optional-authorizationdetails-in-response-body">
<section id="section-6.1">
        <h3 id="name-optional-authorization_deta">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-optional-authorization_deta" class="section-name selfRef">OPTIONAL authorization_details in response body</a>
        </h3>
<p id="section-6.1-1">Resource server <span class="bcp14">MAY</span> provide alongside the <code>insufficient_authorization_details</code> error, an HTTP response body of content type application/json, containing the required authorization details to satisfy the currently failing request.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Note:<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-3.1">
            <p id="section-6.1-3.1.1">Authorization details objects provided by a resource server in an error response are intended for its trusted authorization servers, as advertised by the Resource Server’s metadata endpoint.<a href="#section-6.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-3.2">
            <p id="section-6.1-3.2.1">Resource servers <span class="bcp14">SHALL</span> provide authorization_details objects only if <strong>all</strong> trusted authorization servers accept the <strong>authorization details type</strong> used.<a href="#section-6.1-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.1-4">HTTP response body definition:<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.1-5">
          <dt id="section-6.1-5.1">"authorization_details":</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-5.2">
            <p id="section-6.1-5.2.1"><span class="bcp14">OPTIONAL</span>. Array of authorization details objects, matching the format specified in RAR <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span> for the <code>authorization_details</code> request parameter.<a href="#section-6.1-5.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.1-6">Clients <span class="bcp14">MAY</span> use the provided <code>authorization_details</code> in a subsequent OAuth request to obtain an access token satisfying the resource's requirements.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1-7">Example resource server response with <span class="bcp14">OPTIONAL</span> authorization_details:<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-8">
<pre>
HTTP/1.1 403 Forbidden
WWW-Authenticate: Bearer error="insufficient_authorization_details",
    resource_metadata="https://resource.example.com/
    .well-known/oauth-protected-resource/payments"
Content-Type: application/json
Cache-Control: no-store

{
  "authorization_details": [{
    "type": "payment_initiation",
    "instructedAmount": {
      "currency": "EUR",
      "amount": "100.00"
    },
    "creditorAccount": {
      "iban": "DE02120300000000202051"
    }
  }]
}
</pre><a href="#section-6.1-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="processing-rules">
<section id="section-7">
      <h2 id="name-processing-rules">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-processing-rules" class="section-name selfRef">Processing Rules</a>
      </h2>
<div id="client-processing-rules">
<section id="section-7.1">
        <h3 id="name-client-processing-rules">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-client-processing-rules" class="section-name selfRef">Client Processing Rules</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-7.1-1.1">
            <p id="section-7.1-1.1.1">If encountering error <code>insufficient_authorization_details</code>, check if body.authorization_details exists and if provided <span class="bcp14">MAY</span> include in subsequent OAuth request.<a href="#section-7.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-1.2">
            <p id="section-7.1-1.2.1">Otherwise consult metadata:<a href="#section-7.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-1.2.2.1">
                <p id="section-7.1-1.2.2.1.1">Fetch resource metadata to discover accepted authorization servers and supported <strong>authorization_details types</strong>.<a href="#section-7.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-1.2.2.2">
                <p id="section-7.1-1.2.2.2.1">Fetch authorization server metadata to discover <code>authorization_details_types_supported</code>.<a href="#section-7.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-1.2.2.3">
                <p id="section-7.1-1.2.2.3.1">Fetch authorization server's <code>authorization_details_types_metadata_endpoint</code> to obtain metadata and schema<a href="#section-7.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.1-1.2.2.4">
                <p id="section-7.1-1.2.2.4.1">Locate schema or retrieve schema_uri.<a href="#section-7.1-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-7.1-1.3">
            <p id="section-7.1-1.3.1">Construct authorization details conforming to the schema and include in subsequent OAuth request.<a href="#section-7.1-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="resource-server-processing-rules">
<section id="section-7.2">
        <h3 id="name-resource-server-processing-">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-resource-server-processing-" class="section-name selfRef">Resource Server Processing Rules</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-7.2-1.1">
            <p id="section-7.2-1.1.1">Advertise in resource metadata <code>authorization_details_types_supported</code>, where relevant.<a href="#section-7.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-1.2">
            <p id="section-7.2-1.2.1">Verify access tokens against required authorization details.<a href="#section-7.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-1.3">
            <p id="section-7.2-1.3.1">If insufficient, return HTTP 403 with WWW-Authenticate: Bearer error="insufficient_authorization_details".<a href="#section-7.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-1.4">
            <p id="section-7.2-1.4.1">OPTIONALLY provide also an HTTP body with an informative actionable authorization_details object.<a href="#section-7.2-1.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="cacheability-and-intermediaries">
<section id="section-8.1">
        <h3 id="name-cacheability-and-intermedia">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-cacheability-and-intermedia" class="section-name selfRef">Cacheability and Intermediaries</a>
        </h3>
<p id="section-8.1-1">HTTP 403 responses with response bodies may be cached or replayed in unexpected contexts.
Recommended mitigation is resource servers <span class="bcp14">SHALL</span> use <code>Cache-Control: no-store</code> response header.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="oauth-20-bearer-token-error-registry">
<section id="section-9.1">
        <h3 id="name-oauth-20-bearer-token-error">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-oauth-20-bearer-token-error" class="section-name selfRef">OAuth 2.0 Bearer Token Error Registry</a>
        </h3>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Error Code</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">insufficient_authorization_details</td>
              <td class="text-left" rowspan="1" colspan="1">The request is missing required authorization details or the provided authorization details are insufficient.</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="oauth-metadata-attribute-registration">
<section id="section-9.2">
        <h3 id="name-oauth-metadata-attribute-re">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-oauth-metadata-attribute-re" class="section-name selfRef">OAuth Metadata Attribute Registration</a>
        </h3>
<p id="section-9.2-1">The metadata attribute <code>authorization_details_types_metadata_endpoint</code> is defined for OAuth 2.0 authorization server metadata as a URL.
The metadata attribute <code>authorization_details_types_supported</code> is defined for OAuth 2.0 protected resource metadata.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-normative-references">
<section id="section-10">
      <h2 id="name-normative-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="IANA.oauth-parameters">[IANA.oauth-parameters]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"OAuth Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/oauth-parameters">https://www.iana.org/assignments/oauth-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JSON.Schema">[JSON.Schema]</dt>
      <dd>
<span class="refAuthor">Wright, Ed, A.</span>, <span class="refAuthor">Andrews, Ed, H.</span>, <span class="refAuthor">Hutton, Ed Postman, B.</span>, and <span class="refAuthor">G. Dennis</span>, <span class="refTitle">"JSON Schema: A Media Type for Describing JSON Documents"</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://json-schema.org/draft/2020-12/json-schema-core">https://json-schema.org/draft/2020-12/json-schema-core</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
      <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
      <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8414">[RFC8414]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8414">https://www.rfc-editor.org/rfc/rfc8414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9396">[RFC9396]</dt>
      <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Richer, J.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"OAuth 2.0 Rich Authorization Requests"</span>, <span class="seriesInfo">RFC 9396</span>, <span class="seriesInfo">DOI 10.17487/RFC9396</span>, <time datetime="2023-05" class="refDate">May 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9396">https://www.rfc-editor.org/rfc/rfc9396</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9728">[RFC9728]</dt>
    <dd>
<span class="refAuthor">Jones, M.B.</span>, <span class="refAuthor">Hunt, P.</span>, and <span class="refAuthor">A. Parecki</span>, <span class="refTitle">"OAuth 2.0 Protected Resource Metadata"</span>, <span class="seriesInfo">RFC 9728</span>, <span class="seriesInfo">DOI 10.17487/RFC9728</span>, <time datetime="2025-04" class="refDate">April 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9728">https://www.rfc-editor.org/rfc/rfc9728</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="examples">
<section id="appendix-A">
      <h2 id="name-examples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="appendix-A-1">This section provides non-normative examples of how this specification may be used to support specific use cases.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="metadata-examples">
<section id="appendix-A.1">
        <h3 id="name-metadata-examples">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-metadata-examples" class="section-name selfRef">Metadata Examples</a>
        </h3>
<div id="example-authorizationdetailstypesmetadataendpoint-response-with-payment-initiation">
<section id="appendix-A.1.1">
          <h4 id="name-example-authorization_detai">
<a href="#appendix-A.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-example-authorization_detai" class="section-name selfRef">Example authorization_details_types_metadata_endpoint response with Payment Initiation</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-A.1.1-1">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json

{
    "authorization_details_types_metadata": {
        "payment_initiation": {
            "version": "1.0",
            "description": "Authorization to initiate a single payment from a payer account to a creditor account.",
            "documentation_uri": "https://example.com/docs/payment-initiation",
            "schema": {
                "$schema": "https://json-schema.org/draft/2020-12/schema",
                "title": "Payment Initiation Authorization Detail",
                "type": "object",
                "required": [
                    "type",
                    "instructed_amount",
                    "creditor_account"
                ],
                "properties": {
                    "type": {
                        "const": "payment_initiation",
                        "description": "Authorization detail type identifier."
                    },
                    "actions": {
                        "type": "array",
                        "description": "Permitted actions for this authorization.",
                        "items": {
                            "type": "string",
                            "enum": ["initiate"]
                        },
                        "minItems": 1,
                        "uniqueItems": true
                    },
                    "instructed_amount": {
                        "type": "object",
                        "description": "Amount and currency of the payment to be initiated.",
                        "required": ["currency", "amount"],
                        "properties": {
                            "currency": {
                                "type": "string",
                                "description": "ISO 4217 currency code.",
                                "pattern": "^[A-Z]{3}$"
                            },
                            "amount": {
                                "type": "string",
                                "description": "Decimal monetary amount represented as a string.",
                                "pattern": "^[0-9]+(\\.[0-9]{1,2})?$"
                            }
                        },
                        "additionalProperties": false
                    },
                    "creditor_account": {
                        "type": "object",
                        "description": "Account to which the payment will be credited.",
                        "required": ["iban"],
                        "properties": {
                            "iban": {
                                "type": "string",
                                "description": "International Bank Account Number (IBAN).",
                                "pattern": "^[A-Z0-9]{15,34}$"
                            }
                        },
                        "additionalProperties": false
                    },
                    "remittance_information": {
                        "type": "string",
                        "description": "Unstructured remittance information for the payment.",
                        "maxLength": 140
                    }
                },
                "additionalProperties": false
            }
        }
    }
}
</pre><a href="#appendix-A.1.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="payment-initiation-with-rar-error-signaling">
<section id="appendix-A.2">
        <h3 id="name-payment-initiation-with-rar">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-payment-initiation-with-rar" class="section-name selfRef">Payment initiation with RAR error signaling</a>
        </h3>
<div id="client-initiates-api-request">
<section id="appendix-A.2.1">
          <h4 id="name-client-initiates-api-reques">
<a href="#appendix-A.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-client-initiates-api-reques" class="section-name selfRef">Client initiates API request</a>
          </h4>
<p id="appendix-A.2.1-1">Client uses access token obtained at login to call payment initiation API<a href="#appendix-A.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.1-2">
<pre>
POST /payments HTTP/1.1
Host: resource.example.com
Content-Type: application/json
Authorization: Bearer eyj... (access token from login)

{
    "type": "payment_initiation",
    "locations": [
        "https://resource.example.com/payments"
    ],
    "instructedAmount": {
        "currency": "EUR",
        "amount": "123.50"
    },
    "creditorName": "Merchant A",
    "creditorAccount": {
        "bic": "ABCIDEFFXXX",
        "iban": "DE02100100109307118603"
    }
}
</pre><a href="#appendix-A.2.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="resource-server-signals-insufficientauthorizationdetails-with-actionable-rar-object">
<section id="appendix-A.2.2">
          <h4 id="name-resource-server-signals-ins">
<a href="#appendix-A.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-resource-server-signals-ins" class="section-name selfRef">Resource server signals insufficient_authorization_details with actionable RAR object</a>
          </h4>
<p id="appendix-A.2.2-1">Resource server requires payment approval and responds with:<a href="#appendix-A.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.2-2">
<pre>
HTTP/1.1 403 Forbidden
WWW-Authenticate: Bearer error="insufficient_authorization_details",
    resource_metadata="https://resource.example.com
    /.well-known/oauth-protected-resource/payments"
Content-Type: application/json
Cache-Control: no-store

{
    "authorization_details": [{
      "type": "payment_initiation",
      "locations": [
          "https://example.com/payments"
      ],
      "instructedAmount": {
          "currency": "EUR",
          "amount": "123.50"
      },
      "creditorName": "Merchant A",
      "creditorAccount": {
          "bic": "ABCIDEFFXXX",
          "iban": "DE02100100109307118603"
      },
      "interactionId": "f81d4fae-7dec-11d0-a765-00a0c91e6bf6",
      "riskProfile": "B-71"
}]
}
</pre><a href="#appendix-A.2.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.2-3">Note: the resource server has added the ephemeral attributes <code>interactionId</code> and <code>riskProfile</code>.<a href="#appendix-A.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-initiates-oauth-flow-using-the-provided-authorizationdetails-object">
<section id="appendix-A.2.3">
          <h4 id="name-client-initiates-oauth-flow">
<a href="#appendix-A.2.3" class="section-number selfRef">A.2.3. </a><a href="#name-client-initiates-oauth-flow" class="section-name selfRef">Client initiates OAuth flow using the provided authorization_details object</a>
          </h4>
<p id="appendix-A.2.3-1">After user approves the request, client obtains single-use access token representing the approved payment<a href="#appendix-A.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-re-attempts-api-request">
<section id="appendix-A.2.4">
          <h4 id="name-client-re-attempts-api-requ">
<a href="#appendix-A.2.4" class="section-number selfRef">A.2.4. </a><a href="#name-client-re-attempts-api-requ" class="section-name selfRef">Client re-attempts API request</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-A.2.4-1">
<pre>
POST /payments HTTP/1.1
Host: resource.example.com
Content-Type: application/json
Authorization: Bearer eyj... (payment approval access token)

{
    "type": "payment_initiation",
    "locations": [
        "https://resource.example.com/payments"
    ],
    "instructedAmount": {
        "currency": "EUR",
        "amount": "123.50"
    },
    "creditorName": "Merchant A",
    "creditorAccount": {
        "bic": "ABCIDEFFXXX",
        "iban": "DE02100100109307118603"
    }
}
</pre><a href="#appendix-A.2.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="resource-server-authorizes-the-request">
<section id="appendix-A.2.5">
          <h4 id="name-resource-server-authorizes-">
<a href="#appendix-A.2.5" class="section-number selfRef">A.2.5. </a><a href="#name-resource-server-authorizes-" class="section-name selfRef">Resource server authorizes the request</a>
          </h4>
<div class="alignLeft art-text artwork" id="appendix-A.2.5-1">
<pre>
HTTP/1.1 201 Accepted
Content-Type: application/json
Cache-Control: no-store

{
    "paymentId": "a81bc81b-dead-4e5d-abff-90865d1e13b1",
    "status": "accepted"
}
</pre><a href="#appendix-A.2.5-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="document-history">
<section id="appendix-B">
      <h2 id="name-document-history">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-B-1">-01<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.1">
          <p id="appendix-B-2.1.1">Authorization details moved to HTTP body and made <span class="bcp14">OPTIONAL</span><a href="#appendix-B-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.2">
          <p id="appendix-B-2.2.1">Metadata pointer from resource metadata url, full authorization details types metadata on authorization server new endpoint<a href="#appendix-B-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-B-3">-00<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-4.1">
          <p id="appendix-B-4.1.1">Document creation<a href="#appendix-B-4.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-C">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
    </h2>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yaron Zehavi</span></div>
<div dir="auto" class="left"><span class="org">Raiffeisen Bank International</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:yaron.zehavi@rbinternational.com" class="email">yaron.zehavi@rbinternational.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
